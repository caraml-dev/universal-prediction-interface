<!DOCTYPE html>

<html>
  <head>
    <title>Protocol Documentation</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700,400italic"/>
    <style>
      body {
        width: 60em;
        margin: 1em auto;
        color: #222;
        font-family: "Ubuntu", sans-serif;
        padding-bottom: 4em;
      }

      h1 {
        font-weight: normal;
        border-bottom: 1px solid #aaa;
        padding-bottom: 0.5ex;
      }

      h2 {
        border-bottom: 1px solid #aaa;
        padding-bottom: 0.5ex;
        margin: 1.5em 0;
      }

      h3 {
        font-weight: normal;
        border-bottom: 1px solid #aaa;
        padding-bottom: 0.5ex;
      }

      a {
        text-decoration: none;
        color: #567e25;
      }

      table {
        width: 100%;
        font-size: 80%;
        border-collapse: collapse;
      }

      thead {
        font-weight: 700;
        background-color: #dcdcdc;
      }

      tbody tr:nth-child(even) {
        background-color: #fbfbfb;
      }

      td {
        border: 1px solid #ccc;
        padding: 0.5ex 2ex;
      }

      td p {
        text-indent: 1em;
        margin: 0;
      }

      td p:nth-child(1) {
        text-indent: 0;  
      }

       
      .field-table td:nth-child(1) {  
        width: 10em;
      }
      .field-table td:nth-child(2) {  
        width: 10em;
      }
      .field-table td:nth-child(3) {  
        width: 6em;
      }
      .field-table td:nth-child(4) {  
        width: auto;
      }

       
      .extension-table td:nth-child(1) {  
        width: 10em;
      }
      .extension-table td:nth-child(2) {  
        width: 10em;
      }
      .extension-table td:nth-child(3) {  
        width: 10em;
      }
      .extension-table td:nth-child(4) {  
        width: 5em;
      }
      .extension-table td:nth-child(5) {  
        width: auto;
      }

       
      .enum-table td:nth-child(1) {  
        width: 10em;
      }
      .enum-table td:nth-child(2) {  
        width: 10em;
      }
      .enum-table td:nth-child(3) {  
        width: auto;
      }

       
      .scalar-value-types-table tr {
        height: 3em;
      }

       
      #toc-container ul {
        list-style-type: none;
        padding-left: 1em;
        line-height: 180%;
        margin: 0;
      }
      #toc > li > a {
        font-weight: bold;
      }

       
      .file-heading {
        width: 100%;
        display: table;
        border-bottom: 1px solid #aaa;
        margin: 4em 0 1.5em 0;
      }
      .file-heading h2 {
        border: none;
        display: table-cell;
      }
      .file-heading a {
        text-align: right;
        display: table-cell;
      }

       
      .badge {
        width: 1.6em;
        height: 1.6em;
        display: inline-block;

        line-height: 1.6em;
        text-align: center;
        font-weight: bold;
        font-size: 60%;

        color: #89ba48;
        background-color: #dff0c8;

        margin: 0.5ex 1em 0.5ex -1em;
        border: 1px solid #fbfbfb;
        border-radius: 1ex;
      }
    </style>

    
    <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
  </head>

  <body>

    <h1 id="title">Protocol Documentation</h1>

    <h2>Table of Contents</h2>

    <div id="toc-container">
      <ul id="toc">
        
          
          <li>
            <a href="#caraml%2fupi%2fv1%2fvalue.proto">caraml/upi/v1/value.proto</a>
            <ul>
              
                <li>
                  <a href="#caraml.upi.v1.NamedValue"><span class="badge">M</span>NamedValue</a>
                </li>
              
              
                <li>
                  <a href="#caraml.upi.v1.NamedValue.Type"><span class="badge">E</span>NamedValue.Type</a>
                </li>
              
              
              
            </ul>
          </li>
        
          
          <li>
            <a href="#caraml%2fupi%2fv1%2fupi.proto">caraml/upi/v1/upi.proto</a>
            <ul>
              
                <li>
                  <a href="#caraml.upi.v1.ModelMetadata"><span class="badge">M</span>ModelMetadata</a>
                </li>
              
                <li>
                  <a href="#caraml.upi.v1.PredictValuesRequest"><span class="badge">M</span>PredictValuesRequest</a>
                </li>
              
                <li>
                  <a href="#caraml.upi.v1.PredictValuesResponse"><span class="badge">M</span>PredictValuesResponse</a>
                </li>
              
                <li>
                  <a href="#caraml.upi.v1.PredictionResultRow"><span class="badge">M</span>PredictionResultRow</a>
                </li>
              
                <li>
                  <a href="#caraml.upi.v1.PredictionRow"><span class="badge">M</span>PredictionRow</a>
                </li>
              
                <li>
                  <a href="#caraml.upi.v1.RequestMetadata"><span class="badge">M</span>RequestMetadata</a>
                </li>
              
                <li>
                  <a href="#caraml.upi.v1.ResponseMetadata"><span class="badge">M</span>ResponseMetadata</a>
                </li>
              
              
              
              
                <li>
                  <a href="#caraml.upi.v1.UniversalPredictionService"><span class="badge">S</span>UniversalPredictionService</a>
                </li>
              
            </ul>
          </li>
        
        <li><a href="#scalar-value-types">Scalar Value Types</a></li>
      </ul>
    </div>

    
      
      <div class="file-heading">
        <h2 id="caraml/upi/v1/value.proto">caraml/upi/v1/value.proto</h2><a href="#title">Top</a>
      </div>
      <p></p>

      
        <h3 id="caraml.upi.v1.NamedValue">NamedValue</h3>
        <p>Represents a named and typed data point.</p><p>Can be used as a prediction input, output or metdadata.</p><p>Oneof types are avoided as these can be difficult to handle</p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>name</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Name describing what the value represents.
Uses include:
- Ensuring ML models process columns in the correct order
- Defining a Feast row entity name
- Parsing metadata to apply traffic rules </p></td>
                </tr>
              
                <tr>
                  <td>type</td>
                  <td><a href="#caraml.upi.v1.NamedValue.Type">NamedValue.Type</a></td>
                  <td></td>
                  <td><p> </p></td>
                </tr>
              
                <tr>
                  <td>double_value</td>
                  <td><a href="#double">double</a></td>
                  <td></td>
                  <td><p> </p></td>
                </tr>
              
                <tr>
                  <td>integer_value</td>
                  <td><a href="#int32">int32</a></td>
                  <td></td>
                  <td><p> </p></td>
                </tr>
              
                <tr>
                  <td>string_value</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p> </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      

      
        <h3 id="caraml.upi.v1.NamedValue.Type">NamedValue.Type</h3>
        <p></p>
        <table class="enum-table">
          <thead>
            <tr><td>Name</td><td>Number</td><td>Description</td></tr>
          </thead>
          <tbody>
            
              <tr>
                <td>TYPE_UNSPECIFIED</td>
                <td>0</td>
                <td><p></p></td>
              </tr>
            
              <tr>
                <td>TYPE_DOUBLE</td>
                <td>1</td>
                <td><p></p></td>
              </tr>
            
              <tr>
                <td>TYPE_INTEGER</td>
                <td>2</td>
                <td><p></p></td>
              </tr>
            
              <tr>
                <td>TYPE_STRING</td>
                <td>3</td>
                <td><p></p></td>
              </tr>
            
          </tbody>
        </table>
      

      

      
    
      
      <div class="file-heading">
        <h2 id="caraml/upi/v1/upi.proto">caraml/upi/v1/upi.proto</h2><a href="#title">Top</a>
      </div>
      <p></p>

      
        <h3 id="caraml.upi.v1.ModelMetadata">ModelMetadata</h3>
        <p></p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>name</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Model name that produce prediction </p></td>
                </tr>
              
                <tr>
                  <td>version</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Model version that produce prediction </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      
        <h3 id="caraml.upi.v1.PredictValuesRequest">PredictValuesRequest</h3>
        <p>Represents a request to predict multiple values</p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>prediction_rows</td>
                  <td><a href="#caraml.upi.v1.PredictionRow">PredictionRow</a></td>
                  <td>repeated</td>
                  <td><p>Collection of prediction instances to be predicted.
Each prediction row correspond to one prediction instance.
NOTE: the ordering of prediction_rows might differ with prediction_result_rows in the response </p></td>
                </tr>
              
                <tr>
                  <td>target_name</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Name of the concept we wish to predict.
In the context of Marketplace&#39;s domain entities,
this will correspond to a Numeric Dimension,
eg. &#34;CancellationProb&#34; or &#34;AcceptanceProb&#34; */ </p></td>
                </tr>
              
                <tr>
                  <td>prediction_context</td>
                  <td><a href="#caraml.upi.v1.NamedValue">NamedValue</a></td>
                  <td>repeated</td>
                  <td><p>Prediction context may contain additional data applicable to all prediction instances
For example it can be used to store information for traffic rules, experimentation
or tracking purposes.
Eg. country_code, service_type, service_area_id </p></td>
                </tr>
              
                <tr>
                  <td>metadata</td>
                  <td><a href="#caraml.upi.v1.RequestMetadata">RequestMetadata</a></td>
                  <td></td>
                  <td><p> </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      
        <h3 id="caraml.upi.v1.PredictValuesResponse">PredictValuesResponse</h3>
        <p></p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>prediction_result_rows</td>
                  <td><a href="#caraml.upi.v1.PredictionResultRow">PredictionResultRow</a></td>
                  <td>repeated</td>
                  <td><p>Prediction results corresponding to the
prediction rows provided in the request. 
NOTE: the ordering of prediction_result_rows might differ with prediction_rows in the request </p></td>
                </tr>
              
                <tr>
                  <td>target_name</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Target name as defined in the request metadata </p></td>
                </tr>
              
                <tr>
                  <td>prediction_context</td>
                  <td><a href="#caraml.upi.v1.NamedValue">NamedValue</a></td>
                  <td>repeated</td>
                  <td><p>Extensible field to cover unforeseen requirements </p></td>
                </tr>
              
                <tr>
                  <td>metadata</td>
                  <td><a href="#caraml.upi.v1.ResponseMetadata">ResponseMetadata</a></td>
                  <td></td>
                  <td><p>Response metadata </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      
        <h3 id="caraml.upi.v1.PredictionResultRow">PredictionResultRow</h3>
        <p></p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>row_id</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Row ID defined by the caller used to join a prediction result with a prediction row </p></td>
                </tr>
              
                <tr>
                  <td>values</td>
                  <td><a href="#caraml.upi.v1.NamedValue">NamedValue</a></td>
                  <td>repeated</td>
                  <td><p>Represents the predicted values corresponding to a 
single prediction row. This will often be the output of an ML model.
This field is repeated to support multi-task models with non-scalar outputs </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      
        <h3 id="caraml.upi.v1.PredictionRow">PredictionRow</h3>
        <p>Represents an single instance we wish to predict.</p><p>Eg. for Matchmaking a prediction row will typically</p><p>correspond to a proposed driver plan</p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>row_id</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Row ID is defined by the client and can be used
to join a prediction row with the prediction result,
and to track predictions generated by multiple models.
The user is expected include row ID (along with prediction ID)
when calling the observations API so that predictions
and observations can be joined. </p></td>
                </tr>
              
                <tr>
                  <td>model_inputs</td>
                  <td><a href="#caraml.upi.v1.NamedValue">NamedValue</a></td>
                  <td>repeated</td>
                  <td><p>Model inputs contain all preprocessed feature that model use to perform prediction.
The feature ordering in model_inputs must be the same as feature order expected by model. 
Model inputs can be populated via 3 ways:
- By performing preprocessing in the client-side and sent as part of original request.
- By transforming raw feature values stored in transformer_inputs.
- By retrieving precomputed feature value from feature store. </p></td>
                </tr>
              
                <tr>
                  <td>transformer_inputs</td>
                  <td><a href="#caraml.upi.v1.NamedValue">NamedValue</a></td>
                  <td>repeated</td>
                  <td><p>Transformer input contains raw values that can be used to enrich model_inputs using transformer.
Typically transformer_inputs contains:
- unprocessed/raw features that requires further processing. 
- list of entities for which their precomputed features are retrieved from feature store. </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      
        <h3 id="caraml.upi.v1.RequestMetadata">RequestMetadata</h3>
        <p></p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>prediction_id</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Unique identifier for each request. Optional.
Prediction ID will generated by the platform. The user is expected
include the prediction ID (along with row ID) when calling
the observations API so that predictions and observations can be joined.
Prediction ID is needed because row ID may not be globally unique
across requests (only locally unique within each request).
If there are experiments with alternative models, the mapping
from prediciton ID to treatment ID will be logged by the platform </p></td>
                </tr>
              
                <tr>
                  <td>request_timestamp</td>
                  <td><a href="#google.protobuf.Timestamp">google.protobuf.Timestamp</a></td>
                  <td></td>
                  <td><p>Timestamp of the request </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      
        <h3 id="caraml.upi.v1.ResponseMetadata">ResponseMetadata</h3>
        <p></p>

        
          <table class="field-table">
            <thead>
              <tr><td>Field</td><td>Type</td><td>Label</td><td>Description</td></tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>prediction_id</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Prediction ID generated by the platform. 
The user is expected include the prediction ID (along with row ID) when calling
the observations API so that predictions and observations can be joined.
Prediction ID is needed because row ID may not be globally unique
across requests (only locally unique within each request).
If there are experiments with alternative models, the mapping
from prediciton ID to treatment ID will be logged by the platform </p></td>
                </tr>
              
                <tr>
                  <td>models</td>
                  <td><a href="#caraml.upi.v1.ModelMetadata">ModelMetadata</a></td>
                  <td>repeated</td>
                  <td><p>List of model that produces the prediction 
This field is repeated to cater for use case such as ensembling several model production results </p></td>
                </tr>
              
                <tr>
                  <td>experiment_id</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p>Optional experimentation metadata </p></td>
                </tr>
              
                <tr>
                  <td>treatment_id</td>
                  <td><a href="#string">string</a></td>
                  <td></td>
                  <td><p> </p></td>
                </tr>
              
            </tbody>
          </table>

          

        
      

      

      

      
        <h3 id="caraml.upi.v1.UniversalPredictionService">UniversalPredictionService</h3>
        <p>Service for performing model prediction</p>
        <table class="enum-table">
          <thead>
            <tr><td>Method Name</td><td>Request Type</td><td>Response Type</td><td>Description</td></tr>
          </thead>
          <tbody>
            
              <tr>
                <td>PredictValues</td>
                <td><a href="#caraml.upi.v1.PredictValuesRequest">PredictValuesRequest</a></td>
                <td><a href="#caraml.upi.v1.PredictValuesResponse">PredictValuesResponse</a></td>
                <td><p></p></td>
              </tr>
            
          </tbody>
        </table>

        
          
          
          <h4>Methods with HTTP bindings</h4>
          <table>
            <thead>
              <tr>
                <td>Method Name</td>
                <td>Method</td>
                <td>Pattern</td>
                <td>Body</td>
              </tr>
            </thead>
            <tbody>
            
              
              
              <tr>
                <td>PredictValues</td>
                <td>POST</td>
                <td>/v1/predict</td>
                <td>*</td>
              </tr>
              
            
            </tbody>
          </table>
          
        
    

    <h2 id="scalar-value-types">Scalar Value Types</h2>
    <table class="scalar-value-types-table">
      <thead>
        <tr><td>.proto Type</td><td>Notes</td><td>C++</td><td>Java</td><td>Python</td><td>Go</td><td>C#</td><td>PHP</td><td>Ruby</td></tr>
      </thead>
      <tbody>
        
          <tr id="double">
            <td>double</td>
            <td></td>
            <td>double</td>
            <td>double</td>
            <td>float</td>
            <td>float64</td>
            <td>double</td>
            <td>float</td>
            <td>Float</td>
          </tr>
        
          <tr id="float">
            <td>float</td>
            <td></td>
            <td>float</td>
            <td>float</td>
            <td>float</td>
            <td>float32</td>
            <td>float</td>
            <td>float</td>
            <td>Float</td>
          </tr>
        
          <tr id="int32">
            <td>int32</td>
            <td>Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint32 instead.</td>
            <td>int32</td>
            <td>int</td>
            <td>int</td>
            <td>int32</td>
            <td>int</td>
            <td>integer</td>
            <td>Bignum or Fixnum (as required)</td>
          </tr>
        
          <tr id="int64">
            <td>int64</td>
            <td>Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint64 instead.</td>
            <td>int64</td>
            <td>long</td>
            <td>int/long</td>
            <td>int64</td>
            <td>long</td>
            <td>integer/string</td>
            <td>Bignum</td>
          </tr>
        
          <tr id="uint32">
            <td>uint32</td>
            <td>Uses variable-length encoding.</td>
            <td>uint32</td>
            <td>int</td>
            <td>int/long</td>
            <td>uint32</td>
            <td>uint</td>
            <td>integer</td>
            <td>Bignum or Fixnum (as required)</td>
          </tr>
        
          <tr id="uint64">
            <td>uint64</td>
            <td>Uses variable-length encoding.</td>
            <td>uint64</td>
            <td>long</td>
            <td>int/long</td>
            <td>uint64</td>
            <td>ulong</td>
            <td>integer/string</td>
            <td>Bignum or Fixnum (as required)</td>
          </tr>
        
          <tr id="sint32">
            <td>sint32</td>
            <td>Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int32s.</td>
            <td>int32</td>
            <td>int</td>
            <td>int</td>
            <td>int32</td>
            <td>int</td>
            <td>integer</td>
            <td>Bignum or Fixnum (as required)</td>
          </tr>
        
          <tr id="sint64">
            <td>sint64</td>
            <td>Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int64s.</td>
            <td>int64</td>
            <td>long</td>
            <td>int/long</td>
            <td>int64</td>
            <td>long</td>
            <td>integer/string</td>
            <td>Bignum</td>
          </tr>
        
          <tr id="fixed32">
            <td>fixed32</td>
            <td>Always four bytes. More efficient than uint32 if values are often greater than 2^28.</td>
            <td>uint32</td>
            <td>int</td>
            <td>int</td>
            <td>uint32</td>
            <td>uint</td>
            <td>integer</td>
            <td>Bignum or Fixnum (as required)</td>
          </tr>
        
          <tr id="fixed64">
            <td>fixed64</td>
            <td>Always eight bytes. More efficient than uint64 if values are often greater than 2^56.</td>
            <td>uint64</td>
            <td>long</td>
            <td>int/long</td>
            <td>uint64</td>
            <td>ulong</td>
            <td>integer/string</td>
            <td>Bignum</td>
          </tr>
        
          <tr id="sfixed32">
            <td>sfixed32</td>
            <td>Always four bytes.</td>
            <td>int32</td>
            <td>int</td>
            <td>int</td>
            <td>int32</td>
            <td>int</td>
            <td>integer</td>
            <td>Bignum or Fixnum (as required)</td>
          </tr>
        
          <tr id="sfixed64">
            <td>sfixed64</td>
            <td>Always eight bytes.</td>
            <td>int64</td>
            <td>long</td>
            <td>int/long</td>
            <td>int64</td>
            <td>long</td>
            <td>integer/string</td>
            <td>Bignum</td>
          </tr>
        
          <tr id="bool">
            <td>bool</td>
            <td></td>
            <td>bool</td>
            <td>boolean</td>
            <td>boolean</td>
            <td>bool</td>
            <td>bool</td>
            <td>boolean</td>
            <td>TrueClass/FalseClass</td>
          </tr>
        
          <tr id="string">
            <td>string</td>
            <td>A string must always contain UTF-8 encoded or 7-bit ASCII text.</td>
            <td>string</td>
            <td>String</td>
            <td>str/unicode</td>
            <td>string</td>
            <td>string</td>
            <td>string</td>
            <td>String (UTF-8)</td>
          </tr>
        
          <tr id="bytes">
            <td>bytes</td>
            <td>May contain any arbitrary sequence of bytes.</td>
            <td>string</td>
            <td>ByteString</td>
            <td>str</td>
            <td>[]byte</td>
            <td>ByteString</td>
            <td>string</td>
            <td>String (ASCII-8BIT)</td>
          </tr>
        
      </tbody>
    </table>
  </body>
</html>

